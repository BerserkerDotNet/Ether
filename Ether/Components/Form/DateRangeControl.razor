@inherits InputItemBase<string>
@inject JsUtils JsUtils

<ValidatedField Properties="@Properties" Title="@Title">
    <input @ref="dateRange" class="form-control" />
</ValidatedField>

@code{

    private ElementRef dateRange;

    [Parameter] new string[] Properties { get; set; }

    [Parameter] DateTime Start { get; set; }
    [Parameter] Action<DateTime> StartChanged { get; set; }

    [Parameter] DateTime End { get; set; }
    [Parameter] Action<DateTime> EndChanged { get; set; }

    protected override async Task OnAfterRenderAsync()
    {
        await JsUtils.DateRangePicker(dateRange, DotNetObjectRef.Create<object>(this));
    }

    [JSInvokable]
    public void OnRangeChanged(string start, string end)
    {
        Start = DateTime.Parse(start);
        StartChanged?.Invoke(Start);
        var endDate = DateTime.Parse(end);
        End = endDate.AddDays(1).AddMilliseconds(-1);
        EndChanged?.Invoke(End);
    }
}